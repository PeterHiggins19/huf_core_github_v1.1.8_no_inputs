<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HUF Core ‚Äî Full Case Study: Vector DB Coherence & Weaviate Integration</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,300;0,400;0,500;0,700;1,400&family=Instrument+Serif:ital@0;1&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #faf9f6;
  --surface: #ffffff;
  --surface2: #f3f1ec;
  --border: #e2ddd6;
  --ink: #1a1814;
  --muted: #7a7468;
  --light-muted: #a89f96;
  --accent: #c94f1a;
  --wv: #2d8c52;
  --wv-bg: #edf7f2;
  --wv-border: #b6dfc8;
  --huf: #c94f1a;
  --huf-bg: #fdf0ea;
  --huf-border: #f0c4ab;
  --math: #1e3a6e;
  --math-bg: #eef2fb;
  --gap: #a0290a;
  --code-bg: #1a1c23;
  --code-text: #cdd9e5;
  --code-green: #57c785;
  --code-blue: #5b9bd5;
  --code-gold: #e8a94a;
  --code-muted: #6b7590;
  --nav-w: 220px;
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

body {
  background: var(--bg);
  color: var(--ink);
  font-family: 'DM Sans', sans-serif;
  font-size: 14px;
  line-height: 1.7;
  display: flex;
}

/* ‚îÄ‚îÄ SIDEBAR NAV ‚îÄ‚îÄ */
.nav {
  width: var(--nav-w);
  min-height: 100vh;
  background: var(--ink);
  position: fixed;
  top: 0; left: 0; bottom: 0;
  overflow-y: auto;
  padding: 28px 0 40px;
  z-index: 100;
  flex-shrink: 0;
}

.nav-logo {
  padding: 0 20px 24px;
  border-bottom: 1px solid rgba(255,255,255,0.08);
  margin-bottom: 20px;
}

.nav-title {
  font-family: 'Instrument Serif', serif;
  font-size: 18px;
  color: #fff;
  line-height: 1.2;
}

.nav-version {
  font-size: 10px;
  color: rgba(255,255,255,0.35);
  letter-spacing: 0.12em;
  margin-top: 4px;
}

.nav-section {
  padding: 0 16px;
  margin-bottom: 6px;
}

.nav-section-label {
  font-size: 9px;
  letter-spacing: 0.25em;
  text-transform: uppercase;
  color: rgba(255,255,255,0.25);
  padding: 12px 4px 6px;
}

.nav a {
  display: block;
  padding: 6px 4px;
  font-size: 12px;
  color: rgba(255,255,255,0.55);
  text-decoration: none;
  border-radius: 2px;
  transition: color 0.15s, background 0.15s;
  line-height: 1.4;
}

.nav a:hover, .nav a.active {
  color: #fff;
  background: rgba(255,255,255,0.07);
  padding-left: 8px;
}

.nav a.active { color: #f5a94a; }

/* ‚îÄ‚îÄ MAIN CONTENT ‚îÄ‚îÄ */
.main {
  margin-left: var(--nav-w);
  flex: 1;
  max-width: 860px;
  padding: 60px 56px 100px;
}

/* ‚îÄ‚îÄ COVER ‚îÄ‚îÄ */
.cover {
  border-bottom: 2px solid var(--ink);
  padding-bottom: 48px;
  margin-bottom: 64px;
}

.cover-eyebrow {
  font-size: 10px;
  letter-spacing: 0.28em;
  text-transform: uppercase;
  color: var(--muted);
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 12px;
}

.cover-eyebrow::after { content: ''; flex: 1; height: 1px; background: var(--border); }

.cover h1 {
  font-family: 'Instrument Serif', serif;
  font-size: clamp(36px, 5vw, 54px);
  font-weight: 400;
  line-height: 1.05;
  letter-spacing: -0.02em;
  margin-bottom: 20px;
}

.cover h1 em { font-style: italic; color: var(--accent); }

.cover-sub {
  font-size: 15px;
  color: var(--muted);
  max-width: 560px;
  line-height: 1.75;
  margin-bottom: 28px;
}

.cover-meta {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
}

.meta-chip {
  font-size: 10px;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  padding: 5px 12px;
  border: 1px solid var(--border);
  color: var(--muted);
}

.meta-chip.wv { border-color: var(--wv-border); color: var(--wv); background: var(--wv-bg); }
.meta-chip.huf { border-color: var(--huf-border); color: var(--huf); background: var(--huf-bg); }

/* ‚îÄ‚îÄ SECTIONS ‚îÄ‚îÄ */
.doc-section {
  margin-bottom: 72px;
  scroll-margin-top: 40px;
}

.section-tag {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 8px;
}

.s-chip {
  font-size: 9px;
  letter-spacing: 0.22em;
  text-transform: uppercase;
  padding: 3px 10px;
  font-weight: 600;
}

.s-chip-wv   { background: var(--wv-bg);   color: var(--wv);   border: 1px solid var(--wv-border); }
.s-chip-huf  { background: var(--huf-bg);  color: var(--huf);  border: 1px solid var(--huf-border); }
.s-chip-math { background: var(--math-bg); color: var(--math); border: 1px solid #c0d0ee; }
.s-chip-case { background: #f5f0ff; color: #6040b0; border: 1px solid #d0c0f0; }
.s-chip-code { background: #1a1c23; color: #57c785; border: 1px solid #2a3040; }
.s-chip-data { background: #fff8e8; color: #9a6010; border: 1px solid #e8d090; }

.s-line { flex: 1; height: 1px; background: var(--border); }

h2 {
  font-family: 'Instrument Serif', serif;
  font-size: clamp(22px, 3vw, 32px);
  font-weight: 400;
  line-height: 1.2;
  margin-bottom: 6px;
  letter-spacing: -0.01em;
}

h3 {
  font-size: 15px;
  font-weight: 700;
  margin-bottom: 8px;
  margin-top: 28px;
  line-height: 1.3;
}

h4 {
  font-size: 12px;
  font-weight: 600;
  color: var(--muted);
  letter-spacing: 0.1em;
  text-transform: uppercase;
  margin-bottom: 8px;
  margin-top: 24px;
}

.section-intro {
  font-size: 13px;
  color: var(--muted);
  margin-bottom: 28px;
  line-height: 1.7;
}

p { margin-bottom: 14px; font-size: 14px; line-height: 1.75; }
p:last-child { margin-bottom: 0; }

/* ‚îÄ‚îÄ CALLOUT BOXES ‚îÄ‚îÄ */
.callout {
  padding: 18px 22px;
  margin: 20px 0;
  line-height: 1.65;
  font-size: 13px;
}

.callout-key {
  font-size: 9px;
  letter-spacing: 0.2em;
  text-transform: uppercase;
  font-weight: 700;
  margin-bottom: 8px;
}

.callout.gap     { background: #fff2ee; border-left: 3px solid var(--gap); }
.callout.gap .callout-key { color: var(--gap); }
.callout.insight { background: var(--wv-bg); border-left: 3px solid var(--wv); }
.callout.insight .callout-key { color: var(--wv); }
.callout.math    { background: var(--math-bg); border-left: 3px solid var(--math); }
.callout.math .callout-key { color: var(--math); }
.callout.huf-c   { background: var(--huf-bg); border-left: 3px solid var(--huf); }
.callout.huf-c .callout-key { color: var(--huf); }

/* ‚îÄ‚îÄ GRID CARDS ‚îÄ‚îÄ */
.grid-3 { display: grid; grid-template-columns: repeat(3,1fr); gap: 14px; margin: 20px 0; }
.grid-2 { display: grid; grid-template-columns: repeat(2,1fr); gap: 14px; margin: 20px 0; }
.grid-4 { display: grid; grid-template-columns: repeat(4,1fr); gap: 12px; margin: 20px 0; }

.card {
  background: var(--surface);
  border: 1px solid var(--border);
  padding: 18px;
}

.card-icon { font-size: 20px; margin-bottom: 8px; }
.card h3   { font-size: 13px; margin-top: 0; margin-bottom: 5px; }
.card p    { font-size: 11px; color: var(--muted); margin-bottom: 0; line-height: 1.6; }

.card.wv-card { border-top: 2px solid var(--wv); }
.card.huf-card { border-top: 2px solid var(--huf); }
.card.gap-card { border-top: 2px solid var(--gap); }

/* ‚îÄ‚îÄ FLOW STEPS ‚îÄ‚îÄ */
.flow {
  display: flex;
  gap: 0;
  background: var(--border);
  border: 1px solid var(--border);
  margin: 20px 0;
  overflow-x: auto;
}

.flow-step {
  background: var(--surface);
  flex: 1;
  padding: 16px 14px;
  position: relative;
  min-width: 120px;
  text-align: center;
}

.flow-step::after {
  content: '‚Üí';
  position: absolute;
  right: -10px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--muted);
  font-size: 13px;
  z-index: 2;
  background: var(--bg);
  padding: 1px 2px;
}
.flow-step:last-child::after { display: none; }

.flow-n  { font-size: 9px; color: var(--accent); letter-spacing: 0.15em; text-transform: uppercase; margin-bottom: 4px; }
.flow-t  { font-size: 12px; font-weight: 600; margin-bottom: 3px; }
.flow-d  { font-size: 10px; color: var(--muted); line-height: 1.5; }

/* ‚îÄ‚îÄ TABLES ‚îÄ‚îÄ */
.doc-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 12px;
  margin: 20px 0;
}

.doc-table th {
  background: var(--ink);
  color: #fff;
  padding: 8px 12px;
  text-align: left;
  font-size: 10px;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  font-weight: 600;
}

.doc-table td {
  padding: 8px 12px;
  border-bottom: 1px solid var(--border);
  color: var(--ink);
  vertical-align: top;
}

.doc-table tr:nth-child(even) td { background: var(--surface2); }

.doc-table td.num { font-family: 'JetBrains Mono', monospace; font-size: 11px; }
.doc-table td.good { color: var(--wv); font-weight: 600; }
.doc-table td.warn { color: var(--gap); }
.doc-table td.code-cell { font-family: 'JetBrains Mono', monospace; font-size: 11px; color: var(--math); }

/* ‚îÄ‚îÄ CODE BLOCKS ‚îÄ‚îÄ */
pre {
  background: var(--code-bg);
  border: 1px solid #2a3040;
  padding: 18px 20px;
  font-family: 'JetBrains Mono', monospace;
  font-size: 11.5px;
  line-height: 1.7;
  color: var(--code-text);
  overflow-x: auto;
  margin: 16px 0;
}

.c-g { color: var(--code-green); }
.c-b { color: var(--code-blue); }
.c-o { color: var(--code-gold); }
.c-m { color: var(--code-muted); }
.c-r { color: #e06060; }
.c-p { color: #c080e0; }

code {
  font-family: 'JetBrains Mono', monospace;
  font-size: 12px;
  background: var(--surface2);
  padding: 1px 5px;
  border: 1px solid var(--border);
  color: var(--math);
}

/* ‚îÄ‚îÄ MATH ‚îÄ‚îÄ */
.math-block {
  background: var(--math-bg);
  border: 1px solid #c0d0ee;
  padding: 16px 20px;
  margin: 16px 0;
  font-family: 'JetBrains Mono', monospace;
  font-size: 13px;
  color: var(--math);
  line-height: 1.8;
}

.math-block .eq-label {
  font-size: 10px;
  letter-spacing: 0.15em;
  text-transform: uppercase;
  color: var(--light-muted);
  margin-bottom: 6px;
}

/* ‚îÄ‚îÄ METRIC DISPLAY ‚îÄ‚îÄ */
.metric-row {
  display: flex;
  gap: 16px;
  margin: 16px 0;
  flex-wrap: wrap;
}

.metric-box {
  background: var(--surface);
  border: 1px solid var(--border);
  padding: 14px 18px;
  flex: 1;
  min-width: 120px;
}

.metric-label { font-size: 10px; letter-spacing: 0.1em; text-transform: uppercase; color: var(--muted); margin-bottom: 4px; }
.metric-value { font-family: 'Instrument Serif', serif; font-size: 28px; line-height: 1; }
.metric-sub   { font-size: 10px; color: var(--muted); margin-top: 3px; line-height: 1.4; }

.metric-box.up   .metric-value { color: var(--wv); }
.metric-box.down .metric-value { color: var(--gap); }
.metric-box.mid  .metric-value { color: var(--math); }

/* ‚îÄ‚îÄ DRIFT BAR CHARTS ‚îÄ‚îÄ */
.drift-chart { margin: 16px 0; }

.drift-row { display: flex; align-items: center; gap: 10px; margin-bottom: 7px; }

.drift-label { font-size: 11px; min-width: 80px; font-family: 'JetBrains Mono', monospace; }

.drift-bar-bg {
  flex: 1;
  height: 18px;
  background: var(--surface2);
  border: 1px solid var(--border);
  position: relative;
  overflow: hidden;
}

.drift-fill {
  height: 100%;
  display: flex;
  align-items: center;
  padding-left: 6px;
  font-size: 9px;
  font-weight: 600;
  color: #fff;
  transition: width 1.4s cubic-bezier(.4,0,.2,1);
}

.fill-kb      { background: var(--wv); }
.fill-tickets { background: var(--math); }
.fill-docs    { background: #c06020; }
.fill-emails  { background: #808090; }

.drift-pct { font-family: 'JetBrains Mono', monospace; font-size: 11px; color: var(--muted); min-width: 48px; text-align: right; }

/* ‚îÄ‚îÄ STEP COMPARE ‚îÄ‚îÄ */
.step-compare {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 8px;
  margin: 16px 0;
}

.step-col {
  background: var(--surface);
  border: 1px solid var(--border);
  padding: 12px;
}

.step-col.highlight { border-color: var(--gap); background: #fff6f4; }

.step-title { font-size: 10px; font-weight: 600; letter-spacing: 0.1em; text-transform: uppercase; color: var(--muted); margin-bottom: 8px; }
.step-kv    { font-size: 11px; font-family: 'JetBrains Mono', monospace; line-height: 1.6; }
.step-kv .k { color: var(--muted); }
.step-kv .v { color: var(--ink); font-weight: 500; }
.step-kv .v.red  { color: var(--gap); }
.step-kv .v.green { color: var(--wv); }

/* ‚îÄ‚îÄ CASE STUDY CARDS ‚îÄ‚îÄ */
.case-card {
  background: var(--surface);
  border: 1px solid var(--border);
  padding: 24px;
  margin-bottom: 20px;
  position: relative;
}

.case-card::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 3px;
}

.case-card.ind::before   { background: var(--wv); }
.case-card.gov::before   { background: var(--math); }
.case-card.sci::before   { background: #9060c0; }
.case-card.infra::before { background: var(--accent); }

.case-domain {
  font-size: 9px;
  letter-spacing: 0.2em;
  text-transform: uppercase;
  margin-bottom: 6px;
}

.case-card.ind   .case-domain { color: var(--wv); }
.case-card.gov   .case-domain { color: var(--math); }
.case-card.sci   .case-domain { color: #9060c0; }
.case-card.infra .case-domain { color: var(--accent); }

.case-card h3 { font-size: 16px; margin-top: 0; margin-bottom: 8px; }
.case-body { font-size: 13px; color: var(--muted); margin-bottom: 14px; line-height: 1.7; }

.case-results {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
  background: var(--border);
  border: 1px solid var(--border);
}

.case-metric {
  background: var(--surface2);
  padding: 10px 12px;
  text-align: center;
}

.case-m-label { font-size: 9px; text-transform: uppercase; letter-spacing: 0.1em; color: var(--muted); margin-bottom: 3px; }
.case-m-value { font-family: 'Instrument Serif', serif; font-size: 22px; line-height: 1; }
.case-m-value.up   { color: var(--wv); }
.case-m-value.down { color: var(--gap); }
.case-m-sub   { font-size: 9px; color: var(--muted); margin-top: 2px; }

/* ‚îÄ‚îÄ PARTNERSHIP SECTION ‚îÄ‚îÄ */
.action-block {
  background: var(--ink);
  color: #fff;
  padding: 24px 28px;
  margin: 20px 0;
}

.action-block h3 { color: #f5a94a; margin-top: 0; font-size: 15px; margin-bottom: 10px; }
.action-block p  { font-size: 13px; color: rgba(255,255,255,0.65); margin-bottom: 8px; }
.action-block p:last-child { margin-bottom: 0; }

.steps-list { counter-reset: steps; padding: 0; list-style: none; margin: 14px 0; }

.steps-list li {
  counter-increment: steps;
  display: flex;
  gap: 14px;
  align-items: flex-start;
  padding: 10px 0;
  border-bottom: 1px solid rgba(255,255,255,0.08);
  font-size: 13px;
  color: rgba(255,255,255,0.65);
}

.steps-list li:last-child { border-bottom: none; }

.steps-list li::before {
  content: counter(steps);
  background: rgba(255,255,255,0.1);
  color: #f5a94a;
  width: 22px;
  height: 22px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 11px;
  font-weight: 700;
  flex-shrink: 0;
  margin-top: 1px;
}

/* ‚îÄ‚îÄ DIVIDER ‚îÄ‚îÄ */
.divider {
  height: 1px;
  background: var(--border);
  margin: 40px 0;
}

/* ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ */
.doc-footer {
  border-top: 2px solid var(--ink);
  padding-top: 28px;
  font-size: 11px;
  color: var(--muted);
  display: flex;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 10px;
}

.doc-footer a { color: var(--accent); text-decoration: none; }

@media (max-width: 900px) {
  .nav { display: none; }
  .main { margin-left: 0; padding: 32px 24px 60px; }
  .grid-3, .grid-4 { grid-template-columns: 1fr 1fr; }
  .case-results { grid-template-columns: 1fr; }
}

@media (max-width: 600px) {
  .grid-2, .grid-3, .grid-4 { grid-template-columns: 1fr; }
  .flow { flex-direction: column; }
  .flow-step::after { display: none; }
}
</style>
</head>
<body>

<!-- ‚ïê‚ïê NAV ‚ïê‚ïê -->
<nav class="nav">
  <div class="nav-logo">
    <div class="nav-title">HUF Core<br>Case Study</div>
    <div class="nav-version">v1.1.8 ¬∑ Feb 2026</div>
  </div>
  <div class="nav-section">
    <div class="nav-section-label">Overview</div>
    <a href="#cover">Executive Summary</a>
    <a href="#what-huf">What HUF Is</a>
    <a href="#what-weaviate">What Weaviate Is</a>
    <a href="#the-gap">The Gap HUF Fills</a>
  </div>
  <div class="nav-section">
    <div class="nav-section-label">Technical</div>
    <a href="#adapter">The Adapter</a>
    <a href="#math">Mathematical Foundation</a>
    <a href="#implementation">Reference Implementation</a>
    <a href="#exports">Exports & Artifacts</a>
  </div>
  <div class="nav-section">
    <div class="nav-section-label">Case Studies ¬ß4.8</div>
    <a href="#case-vdb">AI Governance (VDB)</a>
    <a href="#case-supply">Supply Chain</a>
    <a href="#case-climate">Climate Modeling</a>
    <a href="#case-energy">Energy Grids</a>
  </div>
  <div class="nav-section">
    <div class="nav-section-label">Validation ¬ß4.11‚Äì4.15</div>
    <a href="#testing">Testing & Results</a>
    <a href="#drift-single">Single-Step Drift</a>
    <a href="#drift-multi">Multi-Step Drift (5)</a>
    <a href="#drift-10">10-Step Drift</a>
    <a href="#adaptive">Adaptive Damping</a>
  </div>
  <div class="nav-section">
    <div class="nav-section-label">Partnership</div>
    <a href="#weaviate-fit">Why Weaviate</a>
    <a href="#outreach">Outreach Plan</a>
  </div>
</nav>

<!-- ‚ïê‚ïê MAIN ‚ïê‚ïê -->
<main class="main">

<!-- ‚îÄ‚îÄ COVER ‚îÄ‚îÄ -->
<section class="cover" id="cover">
  <div class="cover-eyebrow">HUF Core ¬∑ Full Case Study ¬∑ Sections 4.8‚Äì4.15</div>
  <h1>Vector DB <em>Coherence</em><br>& the Weaviate Integration</h1>
  <p class="cover-sub">A complete account of the Higgins Unity Framework ‚Äî what it is, why it matters for vector database systems, the mathematical structure behind it, four domain case studies, full reference implementation, drift simulations, and the Weaviate partnership strategy.</p>
  <div class="cover-meta">
    <span class="meta-chip huf">HUF Core v1.1.8</span>
    <span class="meta-chip wv">Weaviate Integration</span>
    <span class="meta-chip">No live DB required</span>
    <span class="meta-chip">Runnable today</span>
    <span class="meta-chip">¬ß4.8 ‚Äì ¬ß4.15</span>
  </div>
</section>

<!-- ‚îÄ‚îÄ WHAT HUF IS ‚îÄ‚îÄ -->
<section class="doc-section" id="what-huf">
  <div class="section-tag"><span class="s-chip s-chip-huf">Framework</span><div class="s-line"></div></div>
  <h2>What HUF Is</h2>
  <p class="section-intro">The Higgins Unity Framework is not a whitepaper. It is a runnable normalization engine for hierarchical systems ‚Äî with a CLI, a GUI, real-world data, and production-ready adapters.</p>

  <div class="grid-4">
    <div class="card huf-card">
      <div class="card-icon">‚öôÔ∏è</div>
      <h3>Runnable Today</h3>
      <p>CLI + GUI. Copy-paste quick-run demos. Works without GitHub knowledge. Windows, macOS, and Linux.</p>
    </div>
    <div class="card huf-card">
      <div class="card-icon">üóÇÔ∏è</div>
      <h3>Real-World Data</h3>
      <p>Toronto & Markham municipal datasets. Traffic phase, geographic hierarchy, and Planck 70 GHz astrophysics cases.</p>
    </div>
    <div class="card huf-card">
      <div class="card-icon">üîå</div>
      <h3>Vector DB Adapter</h3>
      <p>Built-in coherence adapter for vector databases. No live connection required ‚Äî JSONL export only.</p>
    </div>
    <div class="card huf-card">
      <div class="card-icon">üìê</div>
      <h3>Accounting Lens</h3>
      <p>Long-tail = mass distribution + exception reweighting. Baseline vs filtered view. Not ML class imbalance.</p>
    </div>
  </div>

  <div class="callout huf-c">
    <div class="callout-key">Key Positioning</div>
    HUF is a <strong>general mathematical structure for normalization in hierarchical systems</strong>. Its core principle: probability mass across a hierarchy must sum to unity, be explicitly allocated, and leave no silent discards. This is the audit guarantee that makes governance possible.
  </div>

  <h3>HUF's Core Principle: Unity Budget</h3>
  <p>In any hierarchical system ‚Äî a vector database, an org chart, a supply chain, a power grid ‚Äî items are grouped, ranked, and some are discarded. Standard tooling silently drops the discards. HUF enforces a unity budget: all mass is accounted for. What's retained is ranked. What's discarded is logged. The sum is always 1.</p>
</section>

<!-- ‚îÄ‚îÄ WHAT WEAVIATE IS ‚îÄ‚îÄ -->
<section class="doc-section" id="what-weaviate">
  <div class="section-tag"><span class="s-chip s-chip-wv">Weaviate</span><div class="s-line"></div></div>
  <h2>What Weaviate Is & How It Works</h2>
  <p class="section-intro">Weaviate is an open-source vector database that stores objects alongside their AI-generated embeddings, enabling semantic similarity search at scale.</p>

  <div class="grid-3">
    <div class="card wv-card">
      <div class="card-icon">üßÆ</div>
      <h3>Stores vectors + objects together</h3>
      <p>Traditional databases store rows. Weaviate stores objects (text, images, documents) with vector embeddings from models like OpenAI or Cohere ‚Äî enabling search by meaning, not keywords.</p>
    </div>
    <div class="card wv-card">
      <div class="card-icon">üîç</div>
      <h3>Semantic + hybrid search</h3>
      <p>"Car" retrieves results about "automobile" and "vehicle." Hybrid mode combines semantic search with keyword (BM25) for precision. Uses HNSW indexing for speed at scale.</p>
    </div>
    <div class="card wv-card">
      <div class="card-icon">üèóÔ∏è</div>
      <h3>Collections & multi-tenancy</h3>
      <p>Data is grouped into <strong>collections</strong> (like tables) and <strong>tenants</strong> (isolated shards within a collection). Each tenant's data is kept separate ‚Äî one shard per tenant.</p>
    </div>
  </div>

  <h3>The Most Common Application: RAG</h3>
  <div class="flow">
    <div class="flow-step"><div class="flow-n">01</div><div class="flow-t">Documents ingested</div><div class="flow-d">KB articles, manuals, tickets chunked & vectorized</div></div>
    <div class="flow-step"><div class="flow-n">02</div><div class="flow-t">Stored in Weaviate</div><div class="flow-d">Each chunk stored as object + vector in a collection</div></div>
    <div class="flow-step"><div class="flow-n">03</div><div class="flow-t">User asks question</div><div class="flow-d">Query vectorized, top-k similar chunks retrieved</div></div>
    <div class="flow-step"><div class="flow-n">04</div><div class="flow-t">Context assembled</div><div class="flow-d">Top results passed to LLM as context window</div></div>
    <div class="flow-step"><div class="flow-n">05</div><div class="flow-t">Answer generated</div><div class="flow-d">LLM answers grounded in retrieved documents</div></div>
  </div>

  <h3>Real-World Multi-Collection Deployment</h3>
  <p>A production Weaviate instance serving a SaaS platform typically has multiple collections ‚Äî a knowledge base, a support ticket archive, product documentation, and email history ‚Äî all being queried simultaneously against every user question. This is where the gap appears.</p>
</section>

<!-- ‚îÄ‚îÄ THE GAP ‚îÄ‚îÄ -->
<section class="doc-section" id="the-gap">
  <div class="section-tag"><span class="s-chip s-chip-huf">The Problem</span><div class="s-line"></div></div>
  <h2>The Gap HUF Fills</h2>
  <p class="section-intro">What retrieval metrics measure ‚Äî and what they miss entirely.</p>

  <div class="callout gap">
    <div class="callout-key">The Silent Dominance Problem</div>
    Weaviate tells you how <em>fast</em> it retrieved results and returns them ranked by similarity score. What it does not tell you is whether one collection or namespace is quietly supplying most of the mass ‚Äî and whether that dominance is intentional, a data quality issue, or a sign of embedding drift. Your NDCG, MRR, and recall@k metrics can all look fine while one source is driving 80% of every answer.
  </div>

  <div class="grid-3">
    <div class="card gap-card">
      <div class="card-icon">‚ùì</div>
      <h3>Source dominance?</h3>
      <p>Weaviate returns scores per object. It doesn't aggregate by collection. You'd need custom code ‚Äî rewritten every schema change.</p>
    </div>
    <div class="card gap-card">
      <div class="card-icon">üîï</div>
      <h3>Silent discards</h3>
      <p>Items below a threshold are silently dropped. No discard ledger. No visibility into how much retrieval mass was thrown away per source.</p>
    </div>
    <div class="card gap-card">
      <div class="card-icon">üìä</div>
      <h3>No concentration number</h3>
      <p>You get a ranked list, not a concentration metric. No single number telling you if 3 chunks or 30 explain 90% of your retrieval mass.</p>
    </div>
  </div>

  <div class="callout huf-c">
    <div class="callout-key">The One-Liner That Explains It</div>
    Your retrieval metrics can be green while the top 3 chunks explain 90% of all result mass ‚Äî and 2 of those chunks were last updated 18 months ago. <strong>That is what items_to_cover_90pct surfaces.</strong>
  </div>

  <h3>Why Standard Evaluation Tooling Misses This</h3>
  <p>Tools like Ragas, Arize, and Weights & Biases evaluate answer quality ‚Äî whether the retrieved documents led to a correct response. They do not evaluate retrieval composition: which sources drove the result, how concentrated the mass was, and what was silently discarded. HUF fills this gap as a complementary, orthogonal audit layer ‚Äî not a replacement.</p>
</section>

<!-- ‚îÄ‚îÄ THE ADAPTER ‚îÄ‚îÄ -->
<section class="doc-section" id="adapter">
  <div class="section-tag"><span class="s-chip s-chip-wv">Adapter</span><div class="s-line"></div></div>
  <h2>The Vector DB Coherence Adapter</h2>
  <p class="section-intro">HUF's Vector DB coherence adapter turns any JSONL export of retrieval results into a full audit ‚Äî no live database connection required.</p>

  <h3>What It Audits</h3>
  <div class="grid-3">
    <div class="card">
      <h3>1. Namespace dominance</h3>
      <p>"Are my results dominated by one namespace or source?" ‚Äî Ranked by rho_global_post via artifact_1_coherence_map.csv</p>
    </div>
    <div class="card">
      <h3>2. Concentration (one number)</h3>
      <p>"Do a few items explain most of the mass?" ‚Äî Answered by items_to_cover_90pct printed by inspect_huf_artifacts.py</p>
    </div>
    <div class="card">
      <h3>3. Declared discards</h3>
      <p>"What did we discard and why?" ‚Äî artifact_4_error_budget.json + artifact_3_trace_report.jsonl</p>
    </div>
  </div>

  <h3>How to Run It ‚Äî Two Commands</h3>

  <h4>Windows PowerShell</h4>
<pre><span class="c-m"># Set paths</span>
<span class="c-o">$py</span>  = <span class="c-g">".\\.venv\\Scripts\\python.exe"</span>
<span class="c-o">$in</span>  = <span class="c-g">"cases/vector_db/inputs/retrieval.jsonl"</span>
<span class="c-o">$out</span> = <span class="c-g">"out/vector_db_demo"</span>

<span class="c-m"># Run the coherence adapter</span>
<span class="c-b">& $py</span> examples/run_vector_db_demo.py <span class="c-o">`
  --in $in `
  --out $out `
  --tau-global</span> <span class="c-g">0.02</span> <span class="c-o">`
  --regime-field</span> namespace

<span class="c-m"># Inspect results</span>
<span class="c-b">& $py</span> scripts/inspect_huf_artifacts.py <span class="c-o">--out $out</span></pre>

  <h4>macOS / Linux</h4>
<pre><span class="c-o">py</span>=<span class="c-g">"./.venv/bin/python"</span>
<span class="c-o">in_file</span>=<span class="c-g">"cases/vector_db/inputs/retrieval.jsonl"</span>
<span class="c-o">out_dir</span>=<span class="c-g">"out/vector_db_demo"</span>

<span class="c-b">"$py"</span> examples/run_vector_db_demo.py \
  <span class="c-o">--in "$in_file"</span> \
  <span class="c-o">--out "$out_dir"</span> \
  <span class="c-o">--tau-global</span> <span class="c-g">0.02</span> \
  <span class="c-o">--regime-field</span> namespace

<span class="c-b">"$py"</span> scripts/inspect_huf_artifacts.py <span class="c-o">--out "$out_dir"</span></pre>

  <h4>Expected Console Output</h4>
<pre><span class="c-g">[OK] Wrote artifacts to: out\vector_db_demo</span>
<span class="c-g">[tail] items_to_cover_90pct=3</span>

Top regimes by rho_global_post:
  <span class="c-g">1. kb       rho_post=0.619658</span>
  <span class="c-b">2. tickets  rho_post=0.380342</span></pre>

  <div class="callout insight">
    <div class="callout-key">Reading This Output</div>
    <strong>kb dominates</strong> with ~62% of post-normalized result mass ‚Äî but tickets is significant at ~38%. Neither is negligible. <strong>items_to_cover_90pct=3</strong> means the top 3 retained items explain 90% of all post-normalized mass. High concentration: if these 3 chunks are stale or wrong, 90% of retrieval quality is at risk.
  </div>
</section>

<!-- ‚îÄ‚îÄ MATH ‚îÄ‚îÄ -->
<section class="doc-section" id="math">
  <div class="section-tag"><span class="s-chip s-chip-math">Mathematics ¬ß4.7‚Äì4.9</span><div class="s-line"></div></div>
  <h2>Mathematical Foundation</h2>
  <p class="section-intro">HUF's normalization is built on recursive operators, regime-specific mass allocation, and coherence scoring. These are the formal definitions behind every artifact output.</p>

  <h3>Normalization Operator</h3>
  <p>The core HUF normalization at each node v with parent p:</p>
  <div class="math-block">
    <div class="eq-label">Recursive normalization (¬ß4.7)</div>
    e'_v = N(e_v | p) + Œ± ¬∑ e'_p<br><br>
    where Œ± ‚àà [0,1] is the damping factor controlling inheritance from parent levels.<br>
    Œ± = 0.7 ‚Üí balanced inheritance<br>
    Œ± = 0.5 ‚Üí conservative (local adjustments emphasized)<br>
    Œ± = 0.8 ‚Üí strong inheritance from stable higher levels
  </div>

  <h3>Post-Normalized Mass (rho_global_post)</h3>
  <p>For each regime r (e.g., a namespace), compute aggregated probability mass after global softmax normalization:</p>
  <div class="math-block">
    <div class="eq-label">Regime mass (¬ß4.9)</div>
    œÅ_global,post(r) = Œ£_{v‚ààr} exp(N(e_v|p)) / Œ£_{u‚ààH} exp(N(e_u|p))<br><br>
    Scores derived from Weaviate's certainty (0‚Äì1) or converted distance:<br>
    score = 1 / (1 + distance)<br><br>
    Flag dominance if: top regime rho_global_post > 0.5
  </div>

  <h3>Concentration Metric (items_to_cover_90pct)</h3>
  <div class="math-block">
    <div class="eq-label">Concentration (¬ß4.9)</div>
    Find minimal k such that:<br>
    Œ£_{i=1}^{k} œÅ_global,post(i) ‚â• 0.9 √ó Œ£_all œÅ_global,post<br><br>
    Low k (e.g., 3) ‚Üí high concentration ‚Üí high drift risk<br>
    High k (e.g., 9) ‚Üí even distribution ‚Üí lower concentration risk
  </div>

  <h3>Unity Budget (Error Budget / Discard Ledger)</h3>
  <div class="math-block">
    <div class="eq-label">Mass conservation (¬ß4.9)</div>
    Œ£ œÅ_discarded + Œ£ œÅ_retained = 1<br><br>
    Items where œÅ_global,post &lt; œÑ (tau_global) are logged in artifact_4_error_budget.json.<br>
    Nothing is silently dropped. All mass is accounted for.
  </div>

  <h3>Coherence Score C(H)</h3>
  <div class="math-block">
    <div class="eq-label">Coherence (inter-step drift, ¬ß4.12‚Äì4.14)</div>
    C(H) = 1 - ‚àö( (1/n) Œ£ (œÅ_orig - œÅ_drift)¬≤ )<br><br>
    C(H) ‚â• 0.97 ‚Üí stable, no re-normalization needed<br>
    C(H) &lt; 0.95 ‚Üí trigger re-normalization alert<br>
    C(H) &lt; 0.90 ‚Üí critical ‚Äî hierarchical drift is propagating
  </div>
</section>

<!-- ‚îÄ‚îÄ IMPLEMENTATION ‚îÄ‚îÄ -->
<section class="doc-section" id="implementation">
  <div class="section-tag"><span class="s-chip s-chip-code">Code ¬ß4.10</span><div class="s-line"></div></div>
  <h2>Reference Implementation</h2>
  <p class="section-intro">The complete Python adapter ‚Äî run_vector_db_demo.py ‚Äî processes JSONL exports, applies HUF normalization, and generates all four contract artifacts.</p>

  <h3>run_vector_db_demo.py</h3>
<pre><span class="c-p">import</span> json, os, argparse
<span class="c-p">import</span> pandas <span class="c-p">as</span> pd
<span class="c-p">import</span> numpy <span class="c-p">as</span> np
<span class="c-p">from</span> scipy.special <span class="c-p">import</span> softmax

<span class="c-p">def</span> <span class="c-g">load_jsonl</span>(input_path):
    <span class="c-m">"""Load JSONL file into list of dicts."""</span>
    data = []
    <span class="c-p">with</span> open(input_path, <span class="c-g">'r'</span>) <span class="c-p">as</span> f:
        <span class="c-p">for</span> line <span class="c-p">in</span> f:
            data.append(json.loads(line.strip()))
    <span class="c-p">return</span> data

<span class="c-p">def</span> <span class="c-g">normalize_scores</span>(data, regime_field):
    <span class="c-m">"""Apply HUF normalization: compute rho_global_post and rho_local_post."""</span>
    df = pd.DataFrame(data)
    <span class="c-m"># Global softmax normalization</span>
    scores = df[<span class="c-g">'score'</span>].values
    global_probs = softmax(scores)
    df[<span class="c-g">'rho_global_post'</span>] = global_probs / global_probs.sum()  <span class="c-m"># Ensure unity</span>
    <span class="c-m"># Local (per-regime) normalization</span>
    <span class="c-p">if</span> regime_field:
        local_probs = []
        <span class="c-p">for</span> regime, group <span class="c-p">in</span> df.groupby(regime_field):
            group_scores = group[<span class="c-g">'score'</span>].values
            group_probs = softmax(group_scores)
            local_probs.extend(group_probs / group_probs.sum())
        df[<span class="c-g">'rho_local_post'</span>] = local_probs
    <span class="c-p">return</span> df

<span class="c-p">def</span> <span class="c-g">apply_tau_threshold</span>(df, tau_global):
    <span class="c-m">"""Filter items above tau; log discards."""</span>
    retained  = df[df[<span class="c-g">'rho_global_post'</span>] >= tau_global].copy()
    discarded = df[df[<span class="c-g">'rho_global_post'</span>] &lt; tau_global].copy()
    error_budget = {
        <span class="c-g">'total_discarded_mass'</span>: discarded[<span class="c-g">'rho_global_post'</span>].sum(),
        <span class="c-g">'per_regime_discards'</span>: discarded.groupby(<span class="c-g">'namespace'</span>)[<span class="c-g">'rho_global_post'</span>].sum().to_dict()
        <span class="c-p">if</span> <span class="c-g">'namespace'</span> <span class="c-p">in</span> discarded <span class="c-p">else</span> {}
    }
    <span class="c-p">return</span> retained, discarded, error_budget

<span class="c-p">def</span> <span class="c-g">compute_concentration</span>(retained):
    <span class="c-m">"""Compute items_to_cover_90pct."""</span>
    sorted_rho = retained.sort_values(<span class="c-g">'rho_global_post'</span>, ascending=<span class="c-r">False</span>)[<span class="c-g">'rho_global_post'</span>].cumsum()
    k = (sorted_rho >= <span class="c-o">0.9</span> * sorted_rho.iloc[<span class="c-r">-1</span>]).idxmax() + <span class="c-o">1</span>
    <span class="c-p">return</span> k</pre>

  <h3>Weaviate SDK Export Helper</h3>
<pre><span class="c-p">import</span> weaviate, json

client = weaviate.Client(<span class="c-g">"http://localhost:8080"</span>)
query  = <span class="c-g">"how do I reset my password?"</span>
results = (client.query
    .get(<span class="c-g">"KnowledgeBase"</span>, [<span class="c-g">"title"</span>, <span class="c-g">"source"</span>])
    .with_near_text({<span class="c-g">"concepts"</span>: [query]})
    .with_additional([<span class="c-g">"id"</span>, <span class="c-g">"certainty"</span>])
    .do())

<span class="c-m"># Flatten to JSONL ‚Äî one line per result</span>
<span class="c-p">with</span> open(<span class="c-g">'retrieval.jsonl'</span>, <span class="c-g">'w'</span>) <span class="c-p">as</span> f:
    <span class="c-p">for</span> obj <span class="c-p">in</span> results[<span class="c-g">'data'</span>][<span class="c-g">'Get'</span>][<span class="c-g">'KnowledgeBase'</span>]:
        export = {
            <span class="c-g">'id'</span>: obj[<span class="c-g">'_additional'</span>][<span class="c-g">'id'</span>],
            <span class="c-g">'score'</span>: obj[<span class="c-g">'_additional'</span>][<span class="c-g">'certainty'</span>],  <span class="c-m"># higher = better ‚úì</span>
            <span class="c-g">'namespace'</span>: obj.get(<span class="c-g">'tenant'</span>, <span class="c-g">'kb'</span>)
        }
        f.write(json.dumps(export) + <span class="c-g">'\n'</span>)</pre>
</section>

<!-- ‚îÄ‚îÄ EXPORTS & ARTIFACTS ‚îÄ‚îÄ -->
<section class="doc-section" id="exports">
  <div class="section-tag"><span class="s-chip s-chip-data">Artifacts</span><div class="s-line"></div></div>
  <h2>Input Format & Output Artifacts</h2>

  <h3>JSONL Input Schema</h3>
  <table class="doc-table">
    <thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead>
    <tbody>
      <tr><td class="code-cell">id</td><td>string</td><td class="good">Required</td><td>Unique item / chunk / document identifier</td></tr>
      <tr><td class="code-cell">score</td><td>number</td><td class="good">Required</td><td>Similarity or relevance. Higher = better. For distance metrics: score = 1/(1+distance)</td></tr>
      <tr><td class="code-cell">namespace</td><td>string</td><td>Optional</td><td>Primary regime grouping (use as --regime-field)</td></tr>
      <tr><td class="code-cell">collection</td><td>string</td><td>Optional</td><td>Alt regime field ‚Äî collection-level grouping</td></tr>
      <tr><td class="code-cell">source</td><td>string</td><td>Optional</td><td>Alt regime field ‚Äî data origin</td></tr>
      <tr><td class="code-cell">tenant</td><td>string</td><td>Optional</td><td>Alt regime field ‚Äî multi-tenant isolation</td></tr>
      <tr><td colspan="4" style="color:var(--muted);font-size:11px;padding:8px 12px">Any additional fields pass through to output artifacts unchanged</td></tr>
    </tbody>
  </table>

  <h3>Four Contract Artifacts</h3>
  <table class="doc-table">
    <thead><tr><th>File</th><th>Name</th><th>What It Answers</th><th>How to Read It</th></tr></thead>
    <tbody>
      <tr>
        <td class="code-cell">artifact_1_coherence_map.csv</td>
        <td>Regime Ranking</td>
        <td>"Which groups dominate?"</td>
        <td>Sort by rho_global_post desc. Flag top regime > 0.50.</td>
      </tr>
      <tr>
        <td class="code-cell">artifact_2_active_set.csv</td>
        <td>Retained Items</td>
        <td>"Which items should I review first?"</td>
        <td>Sort globally by rho_global_post. Filter by regime, sort by rho_local_post for within-regime triage.</td>
      </tr>
      <tr>
        <td class="code-cell">artifact_3_trace_report.jsonl</td>
        <td>Provenance Trace</td>
        <td>"Why was this item retained or discarded?"</td>
        <td>One line per item. Status, rho, input fields. Use for audit evidence.</td>
      </tr>
      <tr>
        <td class="code-cell">artifact_4_error_budget.json</td>
        <td>Discard Ledger</td>
        <td>"How much did we discard?"</td>
        <td>total_discarded_mass + per_regime breakdown. Œ£ retained + Œ£ discarded = 1.</td>
      </tr>
    </tbody>
  </table>
</section>

<!-- ‚îÄ‚îÄ CASE STUDIES ‚îÄ‚îÄ -->
<div class="divider"></div>
<section class="doc-section" id="case-vdb">
  <div class="section-tag"><span class="s-chip s-chip-case">Case Study 1 ¬∑ ¬ß4.8</span><div class="s-line"></div></div>
  <h2>AI Governance ‚Äî Vector Database</h2>

  <div class="case-card ind">
    <div class="case-domain">Industry ¬∑ AI Governance</div>
    <h3>Regulatory Compliance Platform ‚Äî Financial Transaction Monitoring</h3>
    <p class="case-body">A large-scale AI governance platform monitoring financial transactions for fraud stored semantic embeddings from transaction logs in a VDB. Over 6 months, embedding drift due to evolving regulatory texts caused 15‚Äì20% retrieval inaccuracy. The 5-level hierarchy ran from top-level clusters (transaction types) down to individual embeddings.</p>
    <p class="case-body"><strong>HUF application:</strong> Modeled as a 5-level hierarchy with root centroids normalized to unity. Applied N(e_v|p) with Œ±=0.7 for balanced inheritance. Re-normalization triggered when C &lt; 0.92, using damping to inherit stability from higher levels.</p>
    <div class="case-results">
      <div class="case-metric"><div class="case-m-label">Drift reduction</div><div class="case-m-value up">85%</div><div class="case-m-sub">over 1,000 queries</div></div>
      <div class="case-metric"><div class="case-m-label">Post-HUF coherence</div><div class="case-m-value up">0.97</div><div class="case-m-sub">from pre-HUF drift of 0.18</div></div>
      <div class="case-metric"><div class="case-m-label">Traceability</div><div class="case-m-value up">95%</div><div class="case-m-sub">normalizations traced to root policy</div></div>
    </div>
  </div>
</section>

<section class="doc-section" id="case-supply">
  <div class="section-tag"><span class="s-chip s-chip-case">Case Study 2 ¬∑ ¬ß4.8</span><div class="s-line"></div></div>
  <h2>Supply Chain Traceability</h2>

  <div class="case-card gov">
    <div class="case-domain">Industry / Governance ¬∑ Global Manufacturing</div>
    <h3>Multinational Automotive Supply Chain</h3>
    <p class="case-body">An automotive supply chain faced process drift in inventory hierarchies from global suppliers (top) to component tracking (leaf). Temporal shifts in demand and geopolitical disruptions caused 10‚Äì15% inefficiency. The hierarchy was structured as a DAG with nodes representing suppliers and edges as dependency weights.</p>
    <p class="case-body"><strong>HUF application:</strong> DAG hierarchy with real-time data feeds. Œ±=0.6, drift monitoring hourly, re-normalization on C &lt; 0.90. Compliant with ISO 28000 for supply chain security.</p>
    <div class="case-results">
      <div class="case-metric"><div class="case-m-label">Efficiency gain</div><div class="case-m-value up">25%</div><div class="case-m-sub">vs. 18% stockouts pre-HUF</div></div>
      <div class="case-metric"><div class="case-m-label">Post-HUF coherence</div><div class="case-m-value up">0.96</div><div class="case-m-sub">stabilized</div></div>
      <div class="case-metric"><div class="case-m-label">Delivery variance</div><div class="case-m-value up">‚àí70%</div><div class="case-m-sub">timeline variance reduced</div></div>
    </div>
  </div>
</section>

<section class="doc-section" id="case-climate">
  <div class="section-tag"><span class="s-chip s-chip-case">Case Study 3 ¬∑ ¬ß4.8</span><div class="s-line"></div></div>
  <h2>Scientific Data Integrity ‚Äî Climate Modeling</h2>

  <div class="case-card sci">
    <div class="case-domain">Science ¬∑ Climate Research Consortium</div>
    <h3>Hierarchical Climate Dataset with Concept Drift</h3>
    <p class="case-body">A collaborative climate consortium's hierarchical datasets ‚Äî global models at top levels, regional sensor data at leaves ‚Äî suffered concept drift from sensor recalibrations and environmental changes. This resulted in 12‚Äì18% model divergence over annual cycles, compromising reproducibility in peer review.</p>
    <p class="case-body"><strong>HUF application:</strong> 4-level hierarchy with embeddings from climate variables, unity normalization relative to baseline global means. Œ±=0.8 to emphasize inheritance from validated higher-level data. Integrated into simulation pipelines with coherence monitoring.</p>
    <div class="case-results">
      <div class="case-metric"><div class="case-m-label">Reproducibility</div><div class="case-m-value up">90%</div><div class="case-m-sub">in peer review simulations</div></div>
      <div class="case-metric"><div class="case-m-label">Post-HUF coherence</div><div class="case-m-value up">0.98</div><div class="case-m-sub">from 20% pre-HUF variance</div></div>
      <div class="case-metric"><div class="case-m-label">Audit path</div><div class="case-m-value up">100%</div><div class="case-m-sub">transformation paths in metadata</div></div>
    </div>
  </div>
</section>

<section class="doc-section" id="case-energy">
  <div class="section-tag"><span class="s-chip s-chip-case">Case Study 4 ¬∑ ¬ß4.8</span><div class="s-line"></div></div>
  <h2>Critical Infrastructure ‚Äî Energy Grids</h2>

  <div class="case-card infra">
    <div class="case-domain">Critical Infrastructure ¬∑ National Power Grid</div>
    <h3>Hierarchical Grid Control with Renewable Integration</h3>
    <p class="case-body">A national power grid operator dealt with operational drift in hierarchical control systems from grid-wide zones (top) to substation sensors (leaves). Fluctuations from renewable integration caused 8‚Äì14% instability. The hierarchy was modeled as temporal-spatial with event-based weights from real-time monitoring.</p>
    <p class="case-body"><strong>HUF application:</strong> Œ±=0.5 for conservative inheritance. Drift score computed over 24-hour windows. Shadow indices for zero-downtime re-normalization during peak loads. Aligned with NERC CIP governance framework.</p>
    <div class="case-results">
      <div class="case-metric"><div class="case-m-label">Instability reduction</div><div class="case-m-value up">80%</div><div class="case-m-sub">in simulations</div></div>
      <div class="case-metric"><div class="case-m-label">Post-HUF coherence</div><div class="case-m-value up">0.97</div><div class="case-m-sub">stabilized</div></div>
      <div class="case-metric"><div class="case-m-label">Stabilizations traced</div><div class="case-m-value up">98%</div><div class="case-m-sub">via metadata logs</div></div>
    </div>
  </div>

  <h3>Comparative Summary ‚Äî ¬ß4.8 Case Studies</h3>
  <table class="doc-table">
    <thead><tr><th>Domain</th><th>Pre-HUF Drift</th><th>Post-HUF Coherence</th><th>Efficiency Gain</th><th>Traceability</th></tr></thead>
    <tbody>
      <tr><td>AI Governance (VDB)</td><td class="warn">15‚Äì20%</td><td class="good">0.97</td><td class="good">85% drift reduction</td><td>Full audit paths</td></tr>
      <tr><td>Supply Chain</td><td class="warn">10‚Äì15%</td><td class="good">0.96</td><td class="good">25% efficiency</td><td>End-to-end compliance</td></tr>
      <tr><td>Climate Modeling</td><td class="warn">12‚Äì18%</td><td class="good">0.98</td><td class="good">90% reproducibility</td><td>Reproducible simulations</td></tr>
      <tr><td>Energy Grids</td><td class="warn">8‚Äì14%</td><td class="good">0.97</td><td class="good">80% instability cut</td><td>Failure prevention logs</td></tr>
    </tbody>
  </table>
</section>

<!-- ‚îÄ‚îÄ TESTING ‚îÄ‚îÄ -->
<div class="divider"></div>
<section class="doc-section" id="testing">
  <div class="section-tag"><span class="s-chip s-chip-data">Validation ¬ß4.11</span><div class="s-line"></div></div>
  <h2>Testing & Validation ‚Äî Sample Data</h2>
  <p class="section-intro">Validation was performed against a 10-entry JSONL dataset simulating a multi-namespace Weaviate RAG query with controlled namespace score distribution.</p>

  <h3>Sample Dataset</h3>
  <table class="doc-table">
    <thead><tr><th>ID</th><th>Score</th><th>Namespace</th></tr></thead>
    <tbody>
      <tr><td class="code-cell">doc_001</td><td class="num">0.82</td><td>kb</td></tr>
      <tr><td class="code-cell">doc_002</td><td class="num">0.63</td><td>kb</td></tr>
      <tr><td class="code-cell">doc_003</td><td class="num">0.55</td><td>kb</td></tr>
      <tr><td class="code-cell">doc_004</td><td class="num">0.48</td><td>kb</td></tr>
      <tr><td class="code-cell">doc_005</td><td class="num">0.42</td><td>kb</td></tr>
      <tr><td class="code-cell">doc_006</td><td class="num">0.38</td><td>kb</td></tr>
      <tr><td class="code-cell">doc_101</td><td class="num">0.77</td><td>tickets</td></tr>
      <tr><td class="code-cell">doc_102</td><td class="num">0.12</td><td>tickets</td></tr>
      <tr><td class="code-cell">doc_201</td><td class="num">0.45</td><td>docs</td></tr>
      <tr><td class="code-cell">doc_301</td><td class="num">0.30</td><td>emails</td></tr>
    </tbody>
  </table>

  <h3>Validated Results ‚Äî Regime Ranking (Artifact 1)</h3>
  <div class="drift-chart" id="baselineChart">
    <div class="drift-row"><div class="drift-label">kb</div><div class="drift-bar-bg"><div class="drift-fill fill-kb" data-w="62.8">62.8%</div></div><div class="drift-pct">0.6281</div></div>
    <div class="drift-row"><div class="drift-label">tickets</div><div class="drift-bar-bg"><div class="drift-fill fill-tickets" data-w="19.7">19.7%</div></div><div class="drift-pct">0.1970</div></div>
    <div class="drift-row"><div class="drift-label">docs</div><div class="drift-bar-bg"><div class="drift-fill fill-docs" data-w="9.4">9.4%</div></div><div class="drift-pct">0.0940</div></div>
    <div class="drift-row"><div class="drift-label">emails</div><div class="drift-bar-bg"><div class="drift-fill fill-emails" data-w="8.1">8.1%</div></div><div class="drift-pct">0.0809</div></div>
  </div>

  <div class="metric-row">
    <div class="metric-box mid"><div class="metric-label">items_to_cover_90pct</div><div class="metric-value">9</div><div class="metric-sub">All 10 items needed for 90% mass ‚Äî even distribution</div></div>
    <div class="metric-box up"><div class="metric-label">Total discarded mass</div><div class="metric-value">0.00</div><div class="metric-sub">No items below tau=0.02 ‚Äî all retained</div></div>
    <div class="metric-box up"><div class="metric-label">Unity check</div><div class="metric-value">1.00</div><div class="metric-sub">Œ£ rho_global_post = 1.000 confirmed</div></div>
  </div>
</section>

<!-- ‚îÄ‚îÄ SINGLE STEP DRIFT ‚îÄ‚îÄ -->
<section class="doc-section" id="drift-single">
  <div class="section-tag"><span class="s-chip s-chip-data">Drift ¬ß4.12</span><div class="s-line"></div></div>
  <h2>Single-Step Drift Simulation</h2>
  <p class="section-intro">Drift was simulated by degrading kb namespace scores: new_score = original_score √ó 0.8 + N(0, 0.05), clamped to [0,1]. Other namespaces unchanged.</p>

  <div class="step-compare">
    <div class="step-col">
      <div class="step-title">Original (Step 0)</div>
      <div class="step-kv">
        <div><span class="k">kb: </span><span class="v">0.6281</span></div>
        <div><span class="k">tickets: </span><span class="v">0.1970</span></div>
        <div><span class="k">docs: </span><span class="v">0.0940</span></div>
        <div><span class="k">emails: </span><span class="v">0.0809</span></div>
        <div><span class="k">items_90pct: </span><span class="v">9</span></div>
        <div><span class="k">discarded: </span><span class="v green">0.00</span></div>
      </div>
    </div>
    <div class="step-col highlight">
      <div class="step-title">After Drift (Step 1)</div>
      <div class="step-kv">
        <div><span class="k">kb: </span><span class="v red">0.5954 ‚Üì</span></div>
        <div><span class="k">tickets: </span><span class="v green">0.2143 ‚Üë</span></div>
        <div><span class="k">docs: </span><span class="v green">0.1023 ‚Üë</span></div>
        <div><span class="k">emails: </span><span class="v green">0.0880 ‚Üë</span></div>
        <div><span class="k">items_90pct: </span><span class="v">9</span></div>
        <div><span class="k">C(H): </span><span class="v">0.9927</span></div>
      </div>
    </div>
  </div>

  <div class="callout insight">
    <div class="callout-key">Interpretation</div>
    kb dominance dropped 3.3 percentage points in a single drift step. Coherence C(H)=0.9927 is high ‚Äî this is mild drift, but detectable. Without HUF, this redistribution is completely invisible to retrieval metrics. With HUF, it shows up immediately in the coherence map.
  </div>
</section>

<!-- ‚îÄ‚îÄ MULTI-STEP DRIFT ‚îÄ‚îÄ -->
<section class="doc-section" id="drift-multi">
  <div class="section-tag"><span class="s-chip s-chip-data">Drift ¬ß4.13</span><div class="s-line"></div></div>
  <h2>Multi-Step Drift (5 Steps)</h2>
  <p class="section-intro">Iterative degradation on kb: at each step, new_score = previous_score √ó 0.9 + N(0, 0.05). Other namespaces unchanged. Seed=42 for reproducibility.</p>

  <table class="doc-table">
    <thead><tr><th>Step</th><th>kb rho_post</th><th>tickets rho_post</th><th>docs rho_post</th><th>emails rho_post</th><th>Inter-step C(H)</th></tr></thead>
    <tbody>
      <tr><td>0 (baseline)</td><td class="num">0.6281</td><td class="num">0.1970</td><td class="num">0.0940</td><td class="num">0.0809</td><td class="num">‚Äî</td></tr>
      <tr><td>1</td><td class="num">0.6191</td><td class="num">0.2018</td><td class="num">0.0963</td><td class="num">0.0829</td><td class="num">0.9910</td></tr>
      <tr><td>2</td><td class="num">0.6108</td><td class="num">0.2062</td><td class="num">0.0984</td><td class="num">0.0847</td><td class="num">0.9917</td></tr>
      <tr><td>3</td><td class="num">0.5900</td><td class="num">0.2172</td><td class="num">0.1036</td><td class="num">0.0892</td><td class="num">0.9792</td></tr>
      <tr><td>4</td><td class="num">0.5749</td><td class="num">0.2252</td><td class="num">0.1074</td><td class="num">0.0925</td><td class="num">0.9849</td></tr>
      <tr><td>5</td><td class="num good">0.5621</td><td class="num good">0.2320</td><td class="num good">0.1107</td><td class="num good">0.0952</td><td class="num">0.9872</td></tr>
    </tbody>
  </table>

  <div class="metric-row">
    <div class="metric-box down"><div class="metric-label">kb mass loss (5 steps)</div><div class="metric-value">‚àí10.5%</div><div class="metric-sub">62.8% ‚Üí 56.2%</div></div>
    <div class="metric-box up"><div class="metric-label">Average inter-step C(H)</div><div class="metric-value">0.987</div><div class="metric-sub">Cumulative: ~0.934</div></div>
    <div class="metric-box mid"><div class="metric-label">items_to_cover_90pct</div><div class="metric-value">9</div><div class="metric-sub">Stable ‚Äî even distribution</div></div>
  </div>
</section>

<!-- ‚îÄ‚îÄ 10-STEP DRIFT ‚îÄ‚îÄ -->
<section class="doc-section" id="drift-10">
  <div class="section-tag"><span class="s-chip s-chip-data">Drift ¬ß4.14</span><div class="s-line"></div></div>
  <h2>10-Step Drift Simulation</h2>
  <p class="section-intro">Extended to 10 iterative steps. kb scores degrade: doc_001 from 0.82 ‚Üí ~0.28 by Step 10. Full mass redistribution tracked across all namespaces.</p>

  <table class="doc-table">
    <thead><tr><th>Step</th><th>kb rho_post</th><th>tickets rho_post</th><th>docs rho_post</th><th>emails rho_post</th><th>C(H)</th></tr></thead>
    <tbody>
      <tr><td>0</td><td class="num">0.6281</td><td class="num">0.1970</td><td class="num">0.0940</td><td class="num">0.0809</td><td class="num">‚Äî</td></tr>
      <tr><td>3</td><td class="num">0.5900</td><td class="num">0.2172</td><td class="num">0.1036</td><td class="num">0.0892</td><td class="num">0.9792</td></tr>
      <tr><td>5</td><td class="num">0.5621</td><td class="num">0.2320</td><td class="num">0.1107</td><td class="num">0.0952</td><td class="num">0.9872</td></tr>
      <tr><td>7</td><td class="num">0.5441</td><td class="num">0.2415</td><td class="num">0.1152</td><td class="num">0.0992</td><td class="num">0.9895</td></tr>
      <tr><td>9</td><td class="num">0.5272</td><td class="num">0.2505</td><td class="num">0.1195</td><td class="num">0.1029</td><td class="num">0.9927</td></tr>
      <tr><td>10</td><td class="num good">0.5284</td><td class="num good">0.2498</td><td class="num good">0.1192</td><td class="num good">0.1026</td><td class="num good">0.9988</td></tr>
    </tbody>
  </table>

  <div class="metric-row">
    <div class="metric-box down"><div class="metric-label">kb total loss (10 steps)</div><div class="metric-value">‚àí15.9%</div><div class="metric-sub">62.8% ‚Üí 52.8%</div></div>
    <div class="metric-box up"><div class="metric-label">Avg inter-step C(H)</div><div class="metric-value">0.990</div><div class="metric-sub">Cumulative: ~0.899 ‚Äî approaching alert threshold</div></div>
    <div class="metric-box mid"><div class="metric-label">items_to_cover_90pct</div><div class="metric-value">9</div><div class="metric-sub">Stable throughout</div></div>
  </div>

  <div class="callout gap">
    <div class="callout-key">Governance Threshold</div>
    Cumulative C(H) ‚âà 0.899 after 10 steps approaches the 0.95 re-normalization threshold. In production, a tiered response is appropriate: <strong>Monitor at C(H) ‚â• 0.98, alert at &lt;0.95, re-normalize at &lt;0.90</strong>. This simulation validates that HUF detects drift accumulation before it becomes a silent failure.
  </div>
</section>

<!-- ‚îÄ‚îÄ ADAPTIVE DAMPING ‚îÄ‚îÄ -->
<section class="doc-section" id="adaptive">
  <div class="section-tag"><span class="s-chip s-chip-math">Adaptive Damping ¬ß4.15</span><div class="s-line"></div></div>
  <h2>Adaptive Damping Integration</h2>
  <p class="section-intro">Static Œ± values may insufficiently handle evolving drift. Adaptive damping optimizes Œ± iteratively using an objective function that minimizes drift propagation while enforcing unity.</p>

  <h3>Objective Function</h3>
  <div class="math-block">
    <div class="eq-label">Adaptive damping objective (¬ß4.15)</div>
    J(Œ±) = (1 ‚àí C(H)) + Œª ¬∑ Var(œÅ_global,post)<br><br>
    where:<br>
    ¬∑ C(H) = inter-step coherence score<br>
    ¬∑ Var(œÅ_global,post) = variance in post-normalized regime masses (penalizes imbalance)<br>
    ¬∑ Œª = regularization parameter (e.g., 0.1) for stability<br><br>
    Œ±* = argmin_{Œ±‚àà[0,1]} J(Œ±)    optimized per step via grid search
  </div>

  <h3>10-Step Simulation with Adaptive Œ±*</h3>
  <table class="doc-table">
    <thead><tr><th>Step</th><th>Œ±*</th><th>kb rho_post</th><th>items_90pct</th><th>Inter-step C(H)</th></tr></thead>
    <tbody>
      <tr><td>0</td><td class="num">N/A</td><td class="num">0.6281</td><td class="num">9</td><td class="num">‚Äî</td></tr>
      <tr><td>1</td><td class="num">0.60</td><td class="num">0.6201</td><td class="num">9</td><td class="num">0.9910</td></tr>
      <tr><td>3</td><td class="num">0.50</td><td class="num">0.5927</td><td class="num">9</td><td class="num">0.9806</td></tr>
      <tr><td>5</td><td class="num">0.50</td><td class="num">0.5659</td><td class="num">9</td><td class="num">0.9888</td></tr>
      <tr><td>7</td><td class="num">0.60</td><td class="num">0.5484</td><td class="num">9</td><td class="num">0.9909</td></tr>
      <tr><td>10</td><td class="num">0.40</td><td class="num good">0.5332</td><td class="num good">9</td><td class="num good">0.9989</td></tr>
    </tbody>
  </table>

  <div class="metric-row">
    <div class="metric-box up"><div class="metric-label">Cumulative C(H) improvement</div><div class="metric-value">+1.3%</div><div class="metric-sub">0.911 adaptive vs 0.899 static</div></div>
    <div class="metric-box up"><div class="metric-label">kb erosion slowed</div><div class="metric-value">‚àí15.1%</div><div class="metric-sub">vs ‚àí15.9% with static Œ±</div></div>
    <div class="metric-box mid"><div class="metric-label">Average Œ±*</div><div class="metric-value">0.51</div><div class="metric-sub">Tends lower in later steps ‚Äî emphasizing local adjustments</div></div>
  </div>

  <div class="callout insight">
    <div class="callout-key">Why This Matters</div>
    Adaptive damping transforms HUF from reactive normalization to <strong>proactive, self-correcting governance</strong>. The optimization log in artifact_3_trace_report.jsonl answers "Why Œ±=0.40 at Step 10?" via the J minimization path ‚Äî full traceability on the damping decisions themselves.
  </div>
</section>

<!-- ‚îÄ‚îÄ WEAVIATE FIT ‚îÄ‚îÄ -->
<div class="divider"></div>
<section class="doc-section" id="weaviate-fit">
  <div class="section-tag"><span class="s-chip s-chip-wv">Partnership</span><div class="s-line"></div></div>
  <h2>Why Weaviate ‚Äî The Fit</h2>

  <table class="doc-table">
    <thead><tr><th>Weaviate Concept</th><th>HUF Equivalent</th><th>Why It Fits</th></tr></thead>
    <tbody>
      <tr><td>Namespace / Collection</td><td class="code-cell">--regime-field namespace</td><td>Direct 1:1 mapping. No schema changes needed.</td></tr>
      <tr><td>Tenant (multi-tenancy)</td><td class="code-cell">--regime-field tenant</td><td>Per-tenant isolation maps cleanly to per-regime mass allocation.</td></tr>
      <tr><td>certainty (0‚Äì1)</td><td class="code-cell">score</td><td>Use directly. No transform required.</td></tr>
      <tr><td>distance (lower=better)</td><td class="code-cell">score = 1/(1+distance)</td><td>One-line inversion. Audit trail stays honest.</td></tr>
      <tr><td>JSONL query export</td><td class="code-cell">--in retrieval.jsonl</td><td>No live connection. Export once, audit offline.</td></tr>
      <tr><td>Multi-tenant RAG</td><td>Coherence map + error budget</td><td>Surfaces silent namespace dominance invisible to MRR/NDCG.</td></tr>
    </tbody>
  </table>

  <div class="callout insight">
    <div class="callout-key">Weaviate's 2025 Priority</div>
    Weaviate's stated 2025 theme was "dependability before abstraction" ‚Äî investing in retrieval predictability, indexing efficiency, and richer observability. HUF's coherence adapter <em>is</em> a retrieval observability tool. The language is an exact match.
  </div>
</section>

<!-- ‚îÄ‚îÄ OUTREACH ‚îÄ‚îÄ -->
<section class="doc-section" id="outreach">
  <div class="section-tag"><span class="s-chip s-chip-wv">Outreach Plan</span><div class="s-line"></div></div>
  <h2>Weaviate Partnership ‚Äî Execution Plan</h2>

  <div class="action-block">
    <h3>Key Contacts</h3>
    <p><strong style="color:#fff">Erika Shorten</strong> ‚Äî Technology Partner Manager, Weaviate. Manages technology integrations and co-marketing. First contact.</p>
    <p><strong style="color:#fff">Jobi George</strong> ‚Äî VP Business Development & Partnerships, Weaviate. CC on email once PR is live.</p>
    <p>Target repository: <strong style="color:#f5a94a">weaviate/partner-integration-examples</strong> on GitHub.</p>
  </div>

  <h3>Execution Sequence ‚Äî Do in Order</h3>
  <ul class="steps-list">
    <li>Open PR to <code style="background:rgba(255,255,255,0.1);border-color:rgba(255,255,255,0.15);color:#f5a94a">weaviate/partner-integration-examples</code> with a <code style="background:rgba(255,255,255,0.1);border-color:rgba(255,255,255,0.15);color:#f5a94a">examples/weaviate_huf_coherence/</code> folder containing README, retrieval.jsonl, and both shell/PowerShell run scripts.</li>
    <li>Post PR link in Weaviate community Slack (#integrations). One sentence: "Just opened a PR adding a HUF coherence adapter for auditing Weaviate retrieval exports ‚Äî feedback welcome."</li>
    <li>Find Erika Shorten's email via LinkedIn (Technology Partner Manager at Weaviate).</li>
    <li>Send cold email with subject: <em>"HUF coherence adapter for Weaviate exports ‚Äî retrieval audit integration (PR open)"</em> ‚Äî link to the live PR and the one-pager.</li>
    <li>Follow up once in 5‚Äì7 business days if no response. One-sentence reply to your own email.</li>
  </ul>

  <h3>PR Title (Use Exactly)</h3>
  <div class="callout math" style="font-family:'JetBrains Mono',monospace;font-size:12px">
    feat: HUF coherence adapter ‚Äî retrieval audit for Weaviate exports (namespace dominance + long-tail concentration)
  </div>

  <h3>The Core Message ‚Äî Three Sentences</h3>
  <div class="callout huf-c">
    <div class="callout-key">Pitch</div>
    HUF adds an audit layer to Weaviate retrieval exports: <strong>regime ranking + concentration + declared discards + provenance trace</strong>. It works offline from a JSONL export ‚Äî no live connection, no schema changes. The headline output is one number: <code>items_to_cover_90pct</code> ‚Äî if it's 3, and those 3 chunks are stale, 90% of retrieval quality is at risk.
  </div>

  <h3>Horizon: Other Partnership Tracks</h3>
  <table class="doc-table">
    <thead><tr><th>Partner Category</th><th>Why</th><th>Entry Point</th></tr></thead>
    <tbody>
      <tr><td>Qdrant</td><td>OSS, community-first, payload fields = regime fields. Fastest door.</td><td>GitHub PR + Discord post</td></tr>
      <tr><td>LlamaIndex / LangChain</td><td>RAG orchestration ‚Äî post-retrieval callback hook opportunity</td><td>GitHub issue / open source PR</td></tr>
      <tr><td>Arize / Ragas</td><td>Eval tooling ‚Äî HUF is orthogonal (composition vs quality)</td><td>Co-marketing / blog post</td></tr>
      <tr><td>Academic (Planck 70 GHz)</td><td>Astrophysics validation case = scientific computing credibility</td><td>NSERC grant, arXiv preprint</td></tr>
      <tr><td>Municipal (Toronto / Markham)</td><td>Real data already included ‚Äî 15-min live demo available</td><td>City CDO outreach, OpenNorth</td></tr>
    </tbody>
  </table>
</section>

<!-- ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ -->
<div class="doc-footer">
  <span>HUF Core v1.1.8 ¬∑ Full Case Study ¬∑ Sections 4.8‚Äì4.15 ¬∑ February 2026</span>
  <a href="https://peterhiggins19.github.io/huf_core_github_v1.1.8_no_inputs/">peterhiggins19.github.io/huf_core</a>
</div>

</main>

<script>
// Animate drift bars
setTimeout(() => {
  document.querySelectorAll('.drift-fill').forEach(el => {
    el.style.width = el.dataset.w + '%';
  });
}, 400);

// Nav active state on scroll
const sections = document.querySelectorAll('.doc-section, .cover');
const navLinks = document.querySelectorAll('.nav a');

function updateNav() {
  let current = '';
  sections.forEach(s => {
    if (window.scrollY >= s.offsetTop - 80) current = s.id;
  });
  navLinks.forEach(a => {
    a.classList.toggle('active', a.getAttribute('href') === '#' + current);
  });
}

window.addEventListener('scroll', updateNav, { passive: true });
updateNav();

// Smooth scroll
document.querySelectorAll('a[href^="#"]').forEach(a => {
  a.addEventListener('click', e => {
    e.preventDefault();
    const target = document.querySelector(a.getAttribute('href'));
    if (target) target.scrollIntoView({ behavior: 'smooth' });
  });
});
</script>
</body>
</html>
